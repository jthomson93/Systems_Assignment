clear all;
run('constants.m');

K_local = [0:0.01:0.5];
C_local = [0:0:0.05:2];
torque_c = zer(1:length(C_local),1)

for i  = 1:length(K_local)
  
    k = K_local(i);
    
    for j = 1:length(C_local)
        
         c = C_local(j);
         
         sim('enviornment_model_taks3');
         max_toque = max(u_torque(:));
         
         torque_c(j) = max_torque;
   
    end
    
    torque (:,i) = torque_c
    
end

figure;
[X, Y] = meshgrid(K, C);
surface = [X, Y, torque];

minimumTorque = min(min(torque));
[X_min, Y_min] = find(torque == minimumTorque);
K_optimal = K_local(X_min);
C_optimal = C_local(Y_min);

k = K_optimal;
c = C_optimal;

sim('environmental_model_task3','StopTime','1000');

figure(tout, u_torque);
xlabel('Time');
ylabel('Torque (nm')

    